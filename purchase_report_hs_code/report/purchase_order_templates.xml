<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <template
        id="report_purchaseorder_document_hs_code"
        inherit_id="purchase_report_orderlines.report_purchaseorder_document_orderlines"
        priority="50"
    >
        <xpath expr="//th[@name='th_description']" position="before">
            <t t-set="has_hs_code" t-value="False" />

            <t t-foreach="o.order_line" t-as="line">
                <t t-if="line.product_id.hs_code_id">
                    <t t-set="has_hs_code" t-value="True" />
                </t>
            </t>

            <t t-if="o.company_id.always_show_hs_code">
                <t t-set="has_hs_code" t-value="True" />
            </t>

            <t t-if="has_hs_code">
                <th name="th_hs_code">
                    <strong>HS Code</strong>
                </th>
            </t>
            <t t-else="">
                <th name="th_hs_code" style="display: none;">
                    <strong>HS Code</strong>
                </th>
            </t>
        </xpath>

        <xpath expr="//td[@name='td_description']" position="before">
            <t t-if="line.product_id.hs_code_id">
                <td name="td_hs_code">
                    <span t-esc="line.product_id.hs_code_id.local_code" />
                </td>
            </t>
            <t t-elif="not line.product_id.hs_code_id and has_hs_code">
                <td name="td_hs_code_empty" />
            </t>
        </xpath>
    </template>
</odoo>
